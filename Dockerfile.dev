FROM node:24-alpine

WORKDIR /pantheon-dashboard

# Copy local files
COPY . .

# Create data directory
RUN mkdir -p public/uploads
RUN mkdir -p src/app/data

# Add environment variables before building the application.
# Client components are compiled at build time, so they need these values
# to correctly call the API in the browser.
ENV NEXT_PUBLIC_API_BASE=${NEXT_PUBLIC_API_BASE}

# Install dependencies and build
RUN npm install

EXPOSE 3000

VOLUME ["/pantheon-dashboard/public", "/pantheon-dashboard/src/app/data"]

CMD ["npm", "run", "dev"]